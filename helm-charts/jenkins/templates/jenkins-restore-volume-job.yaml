apiVersion: batch/v1
kind: Job
metadata:
  name: jenkins-data-restore
  annotations:
    argocd.argoproj.io/sync-wave: "-5"
    argocd.argoproj.io/hook: PostSync
    argocd.argoproj.io/hook-delete-policy: HookSucceeded
spec:
  template:
    spec:
      containers:
      - name: jenkins-restore
        image: wahooli/longhorn-backup-restore:latest
        env:
        - name: VOLUME_HANDLE
          value: "jenkins-longhorn"
        - name: CREATE_PV
          value: "false" # will not create persistent volume and claims
        - name: CREATE_PVC
          value: "false"
      restartPolicy: Never
  backoffLimit: 0